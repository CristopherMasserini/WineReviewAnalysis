# Compares a varietal between two countries
VarietalComparePerCountries <- function(varietal, CountryA, CountryB){
  ratings = seq(80, 100)
  
  # Creates the table for information to be stored
  VarTable = matrix(NA,ncol = 4, nrow = 21,byrow=TRUE)
  colnames(VarTable) = c(paste(CountryA, "Count"), paste(CountryB, "Count"),
                         paste(CountryA, "Average Price"), paste(CountryB, "Average Price"))
  rownames(VarTable) = ratings
  VarTable = as.table(VarTable)
  
  # Creates data for the two different countries to be used
  CountryAData = wine[which(wine$country == CountryA), ]
  CountryAData = CountryAData[which(CountryAData$variety == varietal), ]
  
  CountryBData = wine[which(wine$country == CountryB), ]
  CountryBData = CountryBData[which(CountryBData$variety == varietal), ]
  
  # Gets the count and average price for the varietal for each country at each rating
  for (i in seq(80:100))
  {
    CounARows = which(CountryAData$points == ratings[i])
    CounBRows = which(CountryBData$points == ratings[i])
    
    # Number of times that varietal occurs for each country
    VarTable[i,1] = signif(length(CounARows), 2)
    VarTable[i,2] = signif(length(CounBRows), 2)
    
    CountryADataRating = CountryAData[CounARows,]
    CountryBDataRating = CountryBData[CounBRows,]
    
    NewRowsA = which(!is.na(CountryADataRating$price))
    NewRowsB = which(!is.na(CountryBDataRating$price))
    
    # Average price for each for the varietal for each country
    VarTable[i,3] = signif(mean(CountryADataRating[NewRowsA, ]$price), 4)
    VarTable[i,4] = signif(mean(CountryBDataRating[NewRowsB, ]$price), 4)
  }
  return(VarTable)
}
